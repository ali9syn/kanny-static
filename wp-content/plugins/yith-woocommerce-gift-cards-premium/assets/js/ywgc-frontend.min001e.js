!function(t){var e=t("div.gift_card_template_button input[name='quantity']").css("display");t(document.body).on("ywgc_request_window_created",function(){t(".pp_content_container").css("position","fixed"),t(".pp_content_container").css("top","50%"),t(".pp_content_container").css("transform","translateY(-50%)"),t(".pp_content_container").css("max-width","80%"),t(".pp_content_container").css("max-height","100%"),t(".pp_content_container .pp_content").css("max-width","100%"),t(".pp_content_container .pp_content").css("max-height","600px"),t(".pp_content_container .pp_content").css("overflow-y","scroll")}),t(document).ready(function(){jQuery().prettyPhoto&&t('[rel="prettyPhoto[ywgc-choose-design]"]').prettyPhoto({hook:"rel",social_tools:!1,theme:"pp_woocommerce",default_width:"80%",default_height:"100%",horizontal_padding:20,opacity:.8,deeplinking:!1,keyboard_shortcuts:!0,allow_resize:!1,changepicturecallback:function(){t(document.body).trigger("ywgc_request_window_created")}}),t("div.ywgc-generator .datepicker").datepicker({dateFormat:"yy-mm-dd",minDate:1,maxDate:"+1Y"})});var a=function(){t('input[name="ywgc-as-present-enabled"]').length&&(t(".ywgc-generator").hide(),c(!1))};function c(e){t("button.gift_card_add_to_cart_button").attr("disabled",!e)}function i(){var e,a=t(".gift-cards-list select");if(!t("#give-as-present").length){t(".gift-cards-list input.ywgc-manual-amount").addClass("ywgc-hidden"),t(".ywgc-manual-amount-error").remove();var i=0;if(0==a.length||"-1"==a.val()){var n=t(".gift-cards-list input.ywgc-manual-amount");if(n.length){var o=n.val();n.removeClass("ywgc-hidden");var r=new RegExp("^[1-9]\\d*(?:\\"+ywgc_data.currency_format_decimal_sep+"\\d{1,2})?$","g");o.length&&!r.test(o)?(n.after('<div class="ywgc-manual-amount-error">'+ywgc_data.manual_amount_wrong_format+"</div>"),c(!1)):parseInt(o)<parseInt(ywgc_data.manual_minimal_amount)&&ywgc_data.manual_minimal_amount_error.length>0?(n.after('<div class="ywgc-manual-amount-error">'+ywgc_data.manual_minimal_amount_error+"</div>"),c(!1)):o?(c(!0),(i=accounting.unformat(o,ywgc_data.mon_decimal_point))<=0?c(!1):(i=accounting.formatMoney(i,{symbol:ywgc_data.currency_format_symbol,decimal:ywgc_data.currency_format_decimal_sep,thousand:ywgc_data.currency_format_thousand_sep,precision:ywgc_data.currency_format_num_decimals,format:ywgc_data.currency_format}),c(!0))):c(!1)}}else a.val()?(c(!0),i=a.children("option:selected").data("wc-price")):c(!1);e=i,t("div.ywgc-card-amount span.amount").text(e)}}function n(e){t("div.ywgc-card-amount span.amount").html(e)}function o(e,a){var c=t(e).closest("div.ywgc-gift-card-content"),i=c.find("div.ywgc-gift-card-edit-details"),n=c.find("div.ywgc-gift-card-details");a?(i.removeClass("ywgc-hide"),i.addClass("ywgc-show"),n.removeClass("ywgc-show"),n.addClass("ywgc-hide")):(i.removeClass("ywgc-show"),i.addClass("ywgc-hide"),n.removeClass("ywgc-hide"),n.addClass("ywgc-show"))}i(),a(),t(document).on("click",".pp_content_container .ywgc-choose-preset",function(e){var a=t(this).data("design-id"),c=t(this).data("design-url");t("#ywgc-main-image").attr("src",c),t(document).trigger("ywgc-picture-changed",["template",a]),t.prettyPhoto.close()}),t(document).on("click","a.ywgc-show-category",function(e){var a=t(this).data("category-id");return t("a.ywgc-show-category").removeClass("ywgc-category-selected"),t(this).addClass("ywgc-category-selected"),"all"!==a?(t(".ywgc-design-item").hide(),t(".ywgc-design-item."+a).show()):t(".ywgc-design-item").show(),!1}),t(document).on("ywgc-picture-changed",function(e,a,c){t("#ywgc-design-type").val(a),t("#ywgc-template-design").val(c)}),t(document).on("click","a.ywgc-show-giftcard",function(){return t(".ywgc-enter-code").slideToggle(400,function(){t(".ywgc-enter-code").find(":input:eq(0)").focus()}),!1}),t("button.ywgc-do-edit").css("display","inline"),t(document).on("input",".gift-cards-list input.ywgc-manual-amount",function(t){i()}),t(document).on("click","a.add-recipient",function(e){var a,c,i;e.preventDefault(),a=t("div.ywgc-single-recipient").last(),c=ywgc_data.mandatory_email?"required":"",i='<div class="ywgc-single-recipient"><input type="email" name="ywgc-recipient-email[]" class="ywgc-recipient yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.email+'" '+c+'/><input type="text" name="ywgc-recipient-name[]" class="yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.name+'" '+c+'/><a href="" disabled class="ywgc-remove-recipient">x</a> </div>',a.after(i),t("a.ywgc-remove-recipient").css("visibility","visible"),t("div.gift_card_template_button input[name='quantity']").css("display","none"),t("div.gift_card_template_button div.ywgc-multi-recipients").length||t("div.gift_card_template_button div.quantity").after("<div class='ywgc-multi-recipients'><span>"+ywgc_data.multiple_recipient+"</span></div>")}),t(document).on("click","a.add-physical-recipient",function(e){var a,c,i;e.preventDefault(),a=t("div.ywgc-single-recipient").last(),c=ywgc_data.mandatory_email?"required":"",i='<div class="ywgc-single-recipient"><input type="text" name="ywgc-recipient-name[]" class="ywgc-recipient yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.name+'" '+c+'/><a href="" disabled class="ywgc-remove-recipient">x</a> </div>',a.after(i),t("a.ywgc-remove-recipient").css("visibility","visible"),t("div.gift_card_template_button input[name='quantity']").css("display","none"),t("div.gift_card_template_button div.ywgc-multi-recipients").length||t("div.gift_card_template_button div.quantity").after("<div class='ywgc-multi-recipients'><span>"+ywgc_data.multiple_recipient+"</span></div>")}),t(document).on("click","a.ywgc-remove-recipient",function(a){var c;a.preventDefault(),c=t(this),t(c).parent("div.ywgc-single-recipient").remove(),1==t('input[name="ywgc-recipient-email[]"]').length&&(t("a.hide-if-alone").css("visibility","hidden"),t("div.gift_card_template_button input[name='quantity']").css("display",e),t("div.ywgc-multi-recipients").remove())}),t(document).on("input","#ywgc-edit-message",function(e){t(".ywgc-card-message").html(t("#ywgc-edit-message").val())}),t(document).on("change",".gift-cards-list select",function(t){i()}),t(document).on("click","a.customize-gift-card",function(e){e.preventDefault(),t("div.summary.entry-summary").after('<div class="ywgc-customizer"></div>')}),t(document).on("click",".ywgc-default-picture",function(e){e.preventDefault();var a=t("#ywgc-upload-picture");a.replaceWith(a=a.clone(!0)),t(".ywgc-main-image img.ywgc-main-image").attr("src",ywgc_data.default_gift_card_image),t(".ywgc-main-image").css("background-color",""),t("div.gift-card-too-small").remove(),t(document).trigger("ywgc-picture-changed",["default"])}),t(".yith-wcpb-product-bundled-items").length&&setTimeout(function(){t("#give-as-present").prop("disabled",!1)},1e3),t("body").on("click",".ywgc-product-picture",function(){var e,a,c,i=t("body .single_add_to_cart_button").next();if("product_id"==t(i).attr("name"))var n=t(i).val();else{i=t(i).next();if("product_id"==t(i).attr("name"))n=t(i).val();else n=t("body .single_add_to_cart_button").val()}if(t(".yith-wcpb-product-bundled-items").length)n=t(".yith-wcpb-bundle-form").find("input[name=add-to-cart]").val();e={action:"yith_wc_gift_card_ajax_replace_for_product_image",product_id:n},a="#yith_wc_gift_card_ajax_replace_for_product_image",t.ajax({data:e,url:ywgc_data.ajax_url,type:"post",beforeSend:function(){t(a).html(c)},error:function(t){console.log("yith_wc_gift_card_ajaxGo ajax error -> "+t)},success:function(e){t(a).html(e)}}),t(document).trigger("ywgc-picture-changed",["product_image"])}),t(document).on("click",".ywgc-custom-picture",function(e){t("#ywgc-upload-picture").click()}),t("#ywgc-upload-picture").on("change",function(){t(".ywgc-picture-error").remove();var e,a,c=t(this).val().split(".").pop().toLowerCase();-1!=t.inArray(c,["gif","png","jpg","jpeg","bmp"])?t(this)[0].files[0].size>1024*ywgc_data.custom_image_max_size*1024&&ywgc_data.custom_image_max_size>0?t("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_size+"</span>"):(e=t(this)[0].files[0],(a=new FileReader).readAsDataURL(e),a.onload=function(e){document.getElementById("ywgc-main-image").src=e.target.result,t(document).trigger("ywgc-picture-changed",["custom"]),t("#ywgc-main-image").width()<t(".ywgc-main-image").width()?(t(".ywgc-main-image").css("background-color","#ffe326"),t(".ywgc-preview").prepend('<div class="gift-card-too-small">'+ywgc_data.notify_custom_image_small+"</div>")):t(".ywgc-main-image").css("background-color","")}):t("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_extension+"</span>")}),t(document).on("click","#give-as-present",function(e){e.preventDefault(),t("#give-as-present").css("display","none"),t("div.ywgc-generator").append('<input type="hidden" name="ywgc-as-present" value="1">'),t(".woocommerce-variation-add-to-cart").length?t("div.ywgc-generator").insertBefore(t(".woocommerce-variation-add-to-cart ")):t("div.ywgc-generator").prependTo(t("form.cart")),t("button.single_add_to_cart_button").data("add-to-cart-text",t("button.single_add_to_cart_button").text()),t("button.single_add_to_cart_button").html(ywgc_data.add_gift_text),t("#ywgc-cancel-gift-card").css("display","inline-block"),t("div.ywgc-generator").css("display","block"),t(".yith-wcpb-product-bundled-items").length&&("yes"==t("#yith_wcyc_automatically_gift_this_product").val()?t(".ywgc-template").before(t(".yith-wcpb-product-bundled-items")):(t(".single_add_to_cart_button").after(t(".yith-wcpb-product-bundled-items")),t(".single_add_to_cart_button").css("margin-bottom","20px")))}),t(document).on("click","#ywgc-cancel-gift-card",function(e){e.preventDefault(),t("div.ywgc-generator input[name='ywgc-as-present']").remove(),t("button.single_add_to_cart_button").html(t("button.single_add_to_cart_button").data("add-to-cart-text")),t("#give-as-present").css("display","inline-block"),t("#ywgc-cancel-gift-card").css("display","none"),t("div.ywgc-generator").css("display","none")}),t(document).on("change","#ywgc-postdated",function(e){t(this).is(":checked")?t("#ywgc-delivery-date").removeClass("ywgc-hidden"):t("#ywgc-delivery-date").addClass("ywgc-hidden")}),t(".variations_form.cart").on("found_variation",function(e,a){void 0!==a&&(t("#give-as-present").prop("disabled",!1),n(""!=a.price_html?t(a.price_html).html():t(".product-type-variable").find(".woocommerce-Price-amount.amount").first().html()))}),t(document).on("reset_data",function(){t("#give-as-present").prop("disabled",!0),n("")}),t(document).on("click","button.ywgc-apply-edit",function(e){var a=t(this),c=a.closest("div.ywgc-gift-card-content"),i=c.find('input[name="ywgc-edit-sender"]').val(),n=c.find('input[name="ywgc-edit-recipient"]').val(),r=c.find('textarea[name="ywgc-edit-message"]').val(),d=c.find('input[name="ywgc-item-id"]').val(),s=c.find('input[name="ywgc-gift-card-id"]'),g=s.val();if(a.hasClass("apply")){var l={action:"edit_gift_card",gift_card_id:g,item_id:d,sender:i,recipient:n,message:r};c.block({message:null,overlayCSS:{background:"#fff url("+ywgc_data.loader+") no-repeat center",opacity:.6}}),t.post(ywgc_data.ajax_url,l,function(t){t.code>0&&(c.find("span.ywgc-sender").text(i),c.find("span.ywgc-recipient").text(n),c.find("span.ywgc-message").text(r),2==t.code&&s.val(t.values.new_id)),c.unblock(),o(a,!1)})}}),t(document).on("click","button.ywgc-cancel-edit",function(e){o(t(this),!1)}),t(document).on("click","button.ywgc-do-edit",function(e){o(t(this),!0)}),t(document).on("click","form.gift-cards_form button.gift_card_add_to_cart_button",function(e){t("div.gift-card-content-editor.step-content p.ywgc-filling-error").remove(),t("#ywgc-postdated").is(":checked")&&!t.datepicker.parseDate("yy-mm-dd",t("#ywgc-delivery-date").val())&&(t("div.gift-card-content-editor.step-content").append('<p class="ywgc-filling-error">'+ywgc_data.missing_scheduled_date+"</p>"),e.preventDefault())}),t(document).on("click",".ywgc-gift-card-content a.edit-details",function(e){e.preventDefault(),t(this).addClass("ywgc-hide"),t("div.ywgc-gift-card-details").toggleClass("ywgc-hide")}),t('.ywgc-single-recipient input[name="ywgc-recipient-email[]"]').each(function(e,a){t(this).on("input",function(){t(this).closest(".ywgc-single-recipient").find(".ywgc-bad-email-format").remove()})}),t(document).on("submit",".gift-cards_form",function(e){var a=!0;t('.ywgc-single-recipient input[name="ywgc-recipient-email[]"]').each(function(e,c){var i;t(this).val()&&(i=t(this).val(),!new RegExp("^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$","i").test(i))&&(t(this).closest(".ywgc-single-recipient").find(".ywgc-bad-email-format").remove(),t(this).after('<span class="ywgc-bad-email-format">'+ywgc_data.email_bad_format+"</span>"),a=!1)}),a||e.preventDefault()}),t(document).on("click","a.ywgc-remove-gift-card ",function(e){e.preventDefault();var a=t(e.currentTarget).parents("table"),c=t(e.currentTarget).data("gift-card-code");r(a);var i={security:ywgc_data.gift_card_nonce,code:c,action:"ywgc_remove_gift_card_code"};t.ajax({type:"POST",url:ywgc_data.ajax_url,data:i,dataType:"html",success:function(e){g(e),t(document.body).trigger("removed_gift_card"),d(a)},complete:function(){l()}})}),t("form.ywgc-enter-code").submit(function(e){e.preventDefault(),r(t(this));var a=t(this),c=a.find('input[name="gift_card_code"]'),i=c.val(),n={security:ywgc_data.gift_card_nonce,code:i,action:"ywgc_apply_gift_card_code"};t.ajax({type:"POST",url:ywgc_data.ajax_url,data:n,dataType:"html",success:function(e){g(e),t(document.body).trigger("applied_gift_card")},complete:function(){d(a),c.val(""),l()}})});var r=function(t){t.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},d=function(t){t.removeClass("processing").unblock()},s=function(t){return ywgc_data.wc_ajax_url.toString().replace("%%endpoint%%",t)},g=function(e){t(".woocommerce-error, .woocommerce-message").remove(),t(ywgc_data.notice_target).before(e)};function l(){r(t("div.cart_totals")),t.ajax({url:s("get_cart_totals"),dataType:"html",success:function(e){t("div.cart_totals").replaceWith(e)}}),t(document.body).trigger("update_checkout")}t(document).on("qv_loader_stop yit_quick_view_loaded flatsome_quickview",function(){i(),a()}),"yes"==t("#yith_show_gift_this_product_form").val()&&t("#give-as-present").click(),"yes"==t("#yith_wcyc_automatically_gift_this_product").val()&&(t("#give-as-present").click(),t(".ywgc-product-picture").click())}(jQuery);